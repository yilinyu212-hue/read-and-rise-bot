import openai
import json
from .crawler import fetch 

def run_rize_insight(title, source, content):
    client = openai.OpenAI(
        api_key="sk-4ee83ed8d53a4390846393de5a23165f", 
        base_url="https://api.deepseek.com"
    )

    prompt = f"""
    ä½ æ˜¯ã€ŠRead & Riseã€‹çš„ä¸»ç¼–ã€‚è¯·åŸºäºæ¥è‡ªã€Š{source}ã€‹çš„æ·±åº¦å¤–åˆŠç´ æï¼Œç”Ÿæˆä¸­æ–‡å†…å‚ã€‚
    
    ã€æ ¸å¿ƒè¦æ±‚ã€‘ï¼š
    1. å¿…é¡»ä½“ç°ã€Š{source}ã€‹çš„ä¸€è´¯æ·±åº¦ï¼Œé¿å…å¹³åº¸ã€‚
    2. å…³é”®å•†ä¸šè¯æ±‡ä¿ç•™è‹±æ–‡åŸè¯ã€‚
    3. åˆ—è¡¨å½¢å¼ï¼Œä¸¥ç¦é•¿æ–‡ï¼Œç¡®ä¿è§†è§‰å‘¼å¸æ„Ÿã€‚

    ç´ æï¼š{content}

    è¯·æŒ‰ JSON æ ¼å¼è¾“å‡ºï¼š
    {{
        "punchline": "ä¸€å¥æ·±åˆ»çš„å•†ä¸šæ´å¯Ÿ",
        "read": "### ğŸ” æ·±åº¦æ‹†è§£ (Deep Dive)\\n- **æ ¸å¿ƒè§‚ç‚¹**: ä¸€å¥è¯è¯´æ˜\\n- **å®æˆ˜æ¡ˆä¾‹**: æ‹†è§£æ–‡ä¸­æ¡ˆä¾‹\\n- **åŸå¥å¯¹ç…§**: æ‘˜å½•ä¸€å¥è‹±æ–‡åŸå¥å¹¶ç¿»è¯‘",
        "rise": "### ğŸš€ å†³ç­–è¡ŒåŠ¨ (Action)\\n- **æ€ç»´æ¨¡å‹**: å…³è”1ä¸ªæ¨¡å‹\\n- **è¡ŒåŠ¨å»ºè®®**: 1æ¡Stop, 1æ¡Start"
    }}
    """
    # åé¢é€»è¾‘åŒå‰ï¼Œç¡®ä¿è¿”å› punchline, read, rise å³å¯
